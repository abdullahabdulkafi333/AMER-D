<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>شركة عامر دهيمش - قائمة الأسعار</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap');
        body { font-family: 'Cairo', sans-serif; background-color: #f1f5f9; }
        .admin-gradient { background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%); }
        .product-card { transition: all 0.2s; border: 1px solid #e2e8f0; }
        .modal-overlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:1000; justify-content:center; align-items:center; cursor: zoom-out; }
    </style>
</head>
<body>

    <header class="admin-gradient text-white p-8 shadow-lg sticky top-0 z-50 text-center">
        <h1 class="text-3xl md:text-4xl font-extrabold">شركة عامر دهيمش</h1>
        <button onclick="loginAdmin()" class="mt-3 text-[10px] bg-white/10 px-4 py-1 rounded-full border border-white/20">لوحة التحكم</button>
    </header>

    <div class="container mx-auto p-4 max-w-3xl">
        <input type="text" id="searchInput" onkeyup="search()" placeholder="ابحث عن صنف..." class="w-full p-4 rounded-2xl shadow-sm mb-6 outline-none focus:ring-2 focus:ring-indigo-600">

        <div id="adminPanel" class="hidden bg-white p-6 rounded-3xl shadow-xl border-2 border-indigo-600 mb-8">
            <h2 class="text-lg font-bold mb-4">إضافة أصناف (تحديث يدوي لسوريا)</h2>
            <div class="grid grid-cols-1 gap-4">
                <input type="text" id="itemName" placeholder="اسم الصنف" class="p-3 border rounded-xl">
                <input type="text" id="itemPack" placeholder="التعبئة" class="p-3 border rounded-xl">
                <input type="text" id="itemPrice" placeholder="السعر" class="p-3 border rounded-xl font-bold">
                <input type="file" id="itemFile" accept="image/*" class="p-2 border rounded-xl text-xs">
            </div>
            <button onclick="addItem()" class="mt-4 w-full bg-green-600 text-white py-3 rounded-xl font-bold">إضافة للقائمة</button>
            
            <div class="mt-6">
                <p class="text-xs text-red-600 font-bold mb-2">انسخ الكود أدناه بالكامل وضعه في ملف data.json على GitHub:</p>
                <textarea id="outputJson" class="w-full h-32 p-2 border text-[10px] font-mono bg-gray-50" readonly></textarea>
                <button onclick="copyJson()" class="mt-2 bg-indigo-600 text-white px-4 py-2 rounded-lg text-sm w-full">نسخ البيانات لتحديث الموقع</button>
            </div>
        </div>

        <div id="grid" class="flex flex-col gap-3">
            <p class="text-center py-10 text-gray-400">جاري تحميل البيانات...</p>
        </div>
    </div>

    <div id="modal" class="modal-overlay" onclick="this.style.display='none'"><img id="zoomImg" src="" class="max-w-[95%] max-h-[85%] rounded-lg"></div>

    <script>
        let products = [];
        
        // جلب البيانات من ملف data.json (يعمل في سوريا بدون حجب)
        fetch('data.json?t=' + Date.now())
            .then(response => response.json())
            .then(data => {
                products = data;
                renderUI();
            }).catch(() => {
                document.getElementById('grid').innerHTML = '<p class="text-center py-10">لا يوجد بيانات مضافة بعد.</p>';
            });

        function renderUI() {
            const grid = document.getElementById('grid');
            grid.innerHTML = '';
            products.forEach((item, index) => {
                grid.innerHTML += `
                    <div class="product-card bg-white p-3 rounded-2xl flex items-center gap-4">
                        <img src="${item.img}" onclick="zoom('${item.img}')" class="w-20 h-20 object-cover rounded-xl cursor-zoom-in border">
                        <div class="flex-grow">
                            <h3 class="text-[15px] font-bold text-gray-800">${item.name}</h3>
                            <span class="text-[11px] font-semibold text-gray-600 bg-gray-100 px-2 py-0.5 rounded-md border border-gray-200">${item.pack}</span>
                        </div>
                        <div class="text-left"><span class="text-xl font-black text-indigo-700">${item.price}</span></div>
                    </div>`;
            });
            document.getElementById('outputJson').value = JSON.stringify(products);
        }

        function addItem() {
            const file = document.getElementById('itemFile').files[0];
            const name = document.getElementById('itemName').value;
            const pack = document.getElementById('itemPack').value;
            const price = document.getElementById('itemPrice').value;
            if (!file || !name) return alert("أكمل البيانات");

            const reader = new FileReader();
            reader.onload = function() {
                products.push({ name, pack, price, img: reader.result });
                renderUI();
                alert("تمت الإضافة للقائمة المؤقتة. لا تنسَ نسخ البيانات وتحديث GitHub.");
            };
            reader.readAsDataURL(file);
        }

        function copyJson() {
            const text = document.getElementById('outputJson');
            text.select();
            document.execCommand('copy');
            alert("تم النسخ! الآن اذهب لـ GitHub وافتح ملف data.json والصق البيانات هناك.");
        }

        function zoom(src) { document.getElementById('zoomImg').src = src; document.getElementById('modal').style.display = 'flex'; }
        function search() {
            let q = document.getElementById('searchInput').value.toLowerCase();
            document.querySelectorAll('.product-card').forEach(c => {
                c.style.display = c.innerText.toLowerCase().includes(q) ? 'flex' : 'none';
            });
        }
        function loginAdmin() { if(prompt("رمز الإدارة:") === "admin123") document.getElementById('adminPanel').classList.toggle('hidden'); }
    </script>
</body>
</html>
